import{a9 as M,u as W,m as G,M as ce,p as de,N as K,a4 as Q,r as l,o as c,k as d,i as t,g as o,a,Q as v,z as y,t as g,h as k,H as me,d as P,K as pe,e as U,ae as _e,af as fe,b as h,aa as z,ab as L,n as w,a5 as ge,y as he}from"./main.2cb7c090.js";import{u as X}from"./notation.c182d613.js";import{_ as Be}from"./SatelliteIcon.cd7ab5d0.js";const ye={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(N){const i=N,T=M();W();const{t:_}=G(),m=X(),B=ce();de();const b=K();Q("utils");function $(s){T.openDialog({title:_("general.are_you_sure"),message:_("notations.confirm_delete"),yesLabel:_("general.ok"),noLabel:_("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(u=>{u&&m.deleteNotation({ids:[s]}).then(f=>(f.data.success&&i.loadData&&i.loadData(),!0))})}return(s,u)=>{const f=l("BaseIcon"),I=l("BaseButton"),C=l("BaseDropdownItem"),D=l("router-link"),x=l("BaseDropdown");return c(),d(x,null,{activator:t(()=>[o(B).name==="notations.view"?(c(),d(I,{key:0,variant:"primary"},{default:t(()=>[a(f,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(c(),d(f,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:t(()=>[o(b).hasAbilities(o(v).EDIT_NOTATION)?(c(),d(D,{key:0,to:`/admin/notations/${N.row.id}/edit`},{default:t(()=>[a(C,null,{default:t(()=>[a(f,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),y(" "+g(s.$t("general.edit")),1)]),_:1})]),_:1},8,["to"])):k("",!0),o(b).hasAbilities(o(v).DELETE_NOTATION)?(c(),d(C,{key:1,onClick:u[0]||(u[0]=R=>$(N.row.id))},{default:t(()=>[a(f,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),y(" "+g(s.$t("general.delete")),1)]),_:1})):k("",!0)]),_:1})}}},be={class:"flex items-center justify-end space-x-5"},ve={class:"relative table-container"},Ie={class:"relative flex items-center justify-end h-5 border-gray-200 border-solid"},ke={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Ne={class:"absolute items-center left-6 top-2.5 select-none"},Ce={class:"relative block"},$e={setup(N){Q("utils");const i=X();me(),W();const T=M(),_=K(),{t:m}=G();let B=P(!1),b=P(!0);const $=_.currentUser.role,s=pe({customer_id:"",note_date:"",note:"",employee_id:""}),u=P(null),f=U(()=>!i.totalNotations&&!b.value),I=U({get:()=>i.selectedNotations,set:n=>i.selectNotation(n)}),C=U(()=>[{key:"status",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"customer_id",label:m("notations.customer")},{key:"employee_id",label:m("notations.employee")},{key:"note_date",label:m("notations.added_on")},{key:"updated_at",label:m("notations.updated_on")},{key:"actions",thClass:"text-right",tdClass:"text-right text-sm font-medium",sortable:!1}]);_e(s,()=>{q()},{debounce:500}),fe(()=>{i.selectAllField&&i.selectAllNotations()});function D(){s.customer_id="",s.note_date="",s.note="",s.employee_id=""}function x(){return _.hasAbilities([v.DELETE_NOTATION,v.EDIT_NOTATION])}function R(){B.value&&D(),B.value=!B.value}function j(){u.value&&u.value.refresh()}function q(){j()}async function J({page:n,filter:r,sort:A}){let V={customer_id:s.customer_id,role:$,note_date:s.note_date,note:s.note,page:n};b.value=!0;let p=await i.fecthNotations(V);return b.value=!1,{data:p.data.data,pagination:{totalPages:p.data.meta.last_page,currentPage:n,totalCount:p.data.meta.total,limit:10}}}function Y(){T.openDialog({title:m("general.are_you_sure"),message:m("notations.confirm_delete",2),yesLabel:m("general.ok"),noLabel:m("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(n=>{n&&i.deleteMultipleNotations().then(r=>{r.data.success&&u.value&&u.value.refresh()})})}return(n,r)=>{const A=l("BaseBreadcrumbItem"),V=l("BaseBreadcrumb"),p=l("BaseIcon"),S=l("BaseButton"),Z=l("BasePageHeader"),ee=l("BaseCustomerSelectInput"),E=l("BaseInputGroup"),te=l("BaseDatePicker"),ae=l("BaseInput"),oe=l("BaseFilterWrapper"),ne=l("BaseEmptyPlaceholder"),le=l("BaseDropdownItem"),se=l("BaseDropdown"),H=l("BaseCheckbox"),O=l("BaseText"),re=l("router-link"),ie=l("BaseTable"),ue=l("BasePage");return c(),d(ue,null,{default:t(()=>[a(Z,{title:n.$t("notations.title")},{actions:t(()=>[h("div",be,[z(a(S,{variant:"primary-outline",onClick:R},{right:t(e=>[o(B)?(c(),d(p,{key:1,name:"XIcon",class:w(e.class)},null,8,["class"])):(c(),d(p,{key:0,class:w(e.class),name:"FilterIcon"},null,8,["class"]))]),default:t(()=>[y(g(n.$t("general.filter"))+" ",1)]),_:1},512),[[L,o(i).totalNotations]]),o(_).hasAbilities(o(v).CREATE_NOTATION)?(c(),d(S,{key:0,onClick:r[0]||(r[0]=e=>n.$router.push("/admin/notations/create"))},{left:t(e=>[a(p,{name:"PlusIcon",class:w(e.class)},null,8,["class"])]),default:t(()=>[y(" "+g(n.$t("notations.add_notation")),1)]),_:1})):k("",!0)])]),default:t(()=>[a(V,null,{default:t(()=>[a(A,{title:n.$t("general.home"),to:"dashboard"},null,8,["title"]),a(A,{title:n.$tc("notations.notation",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(oe,{show:o(B),"row-on-xl":!0,onClear:D},{default:t(()=>[a(E,{label:n.$tc("customers.customer",1)},{default:t(()=>[a(ee,{modelValue:o(s).customer_id,"onUpdate:modelValue":r[1]||(r[1]=e=>o(s).customer_id=e),placeholder:n.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(E,{label:n.$t("notations.added_on")},{default:t(()=>[a(te,{modelValue:o(s).note_date,"onUpdate:modelValue":r[2]||(r[2]=e=>o(s).note_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:n.$tc("notations.note"),class:"text-left"},{default:t(()=>[a(ae,{modelValue:o(s).note,"onUpdate:modelValue":r[3]||(r[3]=e=>o(s).note=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),z(a(ne,{title:n.$t("notations.no_notations"),description:n.$t("notations.list_of_notations")},{actions:t(()=>[o(_).hasAbilities(o(v).CREATE_NOTATION)?(c(),d(S,{key:0,variant:"primary-outline",onClick:r[4]||(r[4]=e=>n.$router.push("/admin/notations/create"))},{left:t(e=>[a(p,{name:"PlusIcon",class:w(e.class)},null,8,["class"])]),default:t(()=>[y(" "+g(n.$t("notations.add_new_notation")),1)]),_:1})):k("",!0)]),default:t(()=>[a(Be,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[L,o(f)]]),z(h("div",ve,[h("div",Ie,[o(i).selectedNotations.length?(c(),d(se,{key:0},{activator:t(()=>[h("span",ke,[y(g(n.$t("general.actions"))+" ",1),a(p,{name:"ChevronDownIcon"})])]),default:t(()=>[a(le,{onClick:Y},{default:t(()=>[a(p,{name:"TrashIcon",class:"mr-3 text-gray-600"}),y(" "+g(n.$t("general.delete")),1)]),_:1})]),_:1})):k("",!0)]),a(ie,{ref:(e,F)=>{F.table=e,u.value=e},data:J,columns:o(C),"placeholder-count":o(i).totalNotations>=20?10:5,class:"mt-3"},ge({header:t(()=>[h("div",Ne,[a(H,{modelValue:o(i).selectAllField,"onUpdate:modelValue":r[5]||(r[5]=e=>o(i).selectAllField=e),variant:"primary",onChange:o(i).selectAllNotations},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[h("div",Ce,[a(H,{id:e.id,modelValue:o(I),"onUpdate:modelValue":r[6]||(r[6]=F=>he(I)?I.value=F:null),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-customer_id":t(({row:e})=>[a(re,{to:{path:`notations/${e.data.id}/edit`}},{default:t(()=>[a(O,{text:e.data.customer.name,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"]),a(O,{text:e.data.customer.contact_name?e.data.customer.contact_name:"",length:30,tag:"span",class:"text-xs text-gray-400"},null,8,["text"])]),_:2},1032,["to"])]),"cell-employee_id":t(({row:e})=>[a(O,{text:e.data.employee.name,length:30,tag:"span"},null,8,["text"])]),"cell-note_date":t(({row:e})=>[h("span",null,g(e.data.formatted_note_date),1)]),"cell-updated_at":t(({row:e})=>[h("span",null,g(e.data.formatted_updated_at),1)]),_:2},[x()?{name:"cell-actions",fn:t(({row:e})=>[a(ye,{row:e.data,table:u.value,"load-data":j},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[L,!o(f)]])]),_:1})}}};export{$e as default};
