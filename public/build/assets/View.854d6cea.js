import{M as O,a9 as K,m as J,K as C,d as v,a4 as Q,u as X,e as B,E as Y,P as Z,r as i,o as m,k as g,i as s,a as r,g as o,n as k,z as F,t as f,h as S,b as l,b6 as W,b7 as ee,c as I,j as te,F as ae}from"./main.2cb7c090.js";import{u as re}from"./paintProtectionWarranty.f4baef04.js";import{u as oe}from"./global.5b7fa7f1.js";import"./auth.38b50123.js";const ne={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 bg-white w-88 xl:block"},se={class:"flex items-center justify-between px-4 pt-8 pb-6 border border-gray-200 border-solid"},le={class:"flex ml-3",role:"group","aria-label":"First group"},ie={class:"px-4 py-1 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},de={class:"px-2"},ce={class:"px-2"},ue={class:"px-2"},me={class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid sw-scroll"},pe={class:"flex-2"},fe={class:"mb-1 not-italic font-medium leading-5 text-gray-500 capitalize text-md"},ye={class:"flex-1 whitespace-nowrap right"},_e={class:"text-sm text-right text-gray-500 non-italic"},he={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},ge={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},be=["src"],Ve={setup(ve){const p=O(),d=re(),y=oe(),j=K(),{tm:_}=J();let h=C({}),a=C({orderBy:"",orderByField:"",vin:""});v(null),v(null);let w=v(!1);v(!1),Q("utils"),X();const N=B(()=>d.selectedViewPaintProtectionWarranty),$=B(()=>a.orderBy==="asc"||a.orderBy==null);B(()=>$.value?_("general.ascending"):_("general.descending"));const D=B(()=>h.unique_hash?`/paint-protection-warranties/pdf/${h.unique_hash}`:!1);Y(p,()=>{z()}),L(),z(),c=Z.exports.debounce(c,500);function q(e){return p.params.id==e}async function L(){await d.fetchPaintProtectionWarranties({limit:"all"},y.companySlug),setTimeout(()=>{R()},500)}async function z(){if(p&&p.params.id){let e=await d.fetchViewPaintProtectionWarranty({id:p.params.id},y.companySlug);e.data&&Object.assign(h,e.data.data)}}function R(){const e=document.getElementById(`paintProtectionWarranty-${p.params.id}`);e&&(e.scrollIntoView({behavior:"smooth"}),e.classList.add("shake"))}async function c(){let e={};a.vin!==""&&a.vin!==null&&a.vin!==void 0&&(e.vin=a.vin),a.orderBy!==null&&a.orderBy!==void 0&&(e.orderBy=a.orderBy),a.orderByField!==null&&a.orderByField!==void 0&&(e.orderByField=a.orderByField),w.value=!0;try{let n=await d.searchPaintProtectionWarranty(e,y.companySlug);w.value=!1,n.data.data&&(d.paintProtectionWarranties=n.data.data)}catch{w.value=!1}}function T(){return a.orderBy==="asc"?(a.orderBy="desc",c(),!0):(a.orderBy="asc",c(),!0)}async function U(){j.openDialog({title:_("general.are_you_sure"),message:_("paint-protection-warranties.confirm_delete"),yesLabel:_("general.ok"),noLabel:_("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(e=>{if(e){let n={id:p.params.id,request_deletion:!0};d.updatePaintProtectionWarranty(n,y.companySlug).then(()=>{router.push(`/${y.companySlug}/customer/paint-protection-warranties`)}).catch(u=>{console.error(u)})}})}return(e,n)=>{const u=i("BaseIcon"),b=i("BaseButton"),E=i("BasePageHeader"),G=i("BaseInput"),P=i("BaseRadio"),x=i("BaseInputGroup"),M=i("BaseFormatMoney"),A=i("router-link"),H=i("BasePage");return m(),g(H,{class:"xl:pl-96"},{default:s(()=>[r(E,{title:o(N).owner_name},{actions:s(()=>[r(b,{variant:"primary-outline",class:"mr-2",tag:"a",href:`/paint-protection-warranties/pdf/${o(h).unique_hash}`,download:""},{left:s(t=>[r(u,{name:"DownloadIcon",class:k(t.class)},null,8,["class"]),F(" "+f(e.$t("paint-protection-warranties.download")),1)]),_:1},8,["href"]),o(h).request_deletion?S("",!0):(m(),g(b,{key:0,class:"mr-2",onClick:U},{left:s(t=>[r(u,{name:"TrashIcon",class:k(t.class)},null,8,["class"]),F(" "+f(e.$t("paint-protection-warranties.delete")),1)]),_:1}))]),_:1},8,["title"]),l("div",ne,[l("div",se,[r(G,{modelValue:o(a).vin,"onUpdate:modelValue":n[0]||(n[0]=t=>o(a).vin=t),placeholder:e.$t("general.search"),type:"text",variant:"gray",onInput:c},{right:s(()=>[r(u,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"]),l("div",le,[r(ee,{position:"bottom-start","width-class":"w-50","position-class":"left-0"},{activator:s(()=>[r(b,{variant:"gray"},{default:s(()=>[r(u,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:s(()=>[l("div",ie,f(e.$t("general.sort_by")),1),l("div",de,[r(W,{class:"pt-3 rounded-md hover:rounded-md"},{default:s(()=>[r(x,{class:"-mt-3 font-normal"},{default:s(()=>[r(P,{id:"filter_vehicle_sale_date",modelValue:o(a).orderByField,"onUpdate:modelValue":[n[1]||(n[1]=t=>o(a).orderByField=t),c],label:e.$t("paint-protection-warranties.vehicle_sale_date"),name:"filter",size:"sm",value:"vehicle_sale_date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),l("div",ce,[r(W,{class:"pt-3 rounded-md hover:rounded-md"},{default:s(()=>[r(x,{class:"-mt-3 font-normal"},{default:s(()=>[r(P,{id:"filter_dealer_name",modelValue:o(a).orderByField,"onUpdate:modelValue":[n[2]||(n[2]=t=>o(a).orderByField=t),c],label:e.$t("paint-protection-warranties.dealer_name"),name:"filter",size:"sm",value:"dealer_name"},null,8,["modelValue","label"])]),_:1})]),_:1})]),l("div",ue,[r(W,{class:"pt-3 rounded-md hover:rounded-md"},{default:s(()=>[r(x,{class:"-mt-3 font-normal"},{default:s(()=>[r(P,{id:"filter_vin",modelValue:o(a).orderByField,"onUpdate:modelValue":[n[3]||(n[3]=t=>o(a).orderByField=t),c],label:e.$t("paint-protection-warranties.vin"),size:"sm",name:"filter",value:"vin"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),r(b,{class:"ml-1",variant:"white",onClick:T},{default:s(()=>[o($)?(m(),g(u,{key:0,name:"SortAscendingIcon",class:"h-5"})):(m(),g(u,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),l("div",me,[(m(!0),I(ae,null,te(o(d).paintProtectionWarranties,(t,V)=>(m(),g(A,{id:"paintProtectionWarranty-"+t.id,key:V,to:`/${o(y).companySlug}/customer/paint-protection-warranties/${t.id}/view`,class:k(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":q(t.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:s(()=>[l("div",pe,[l("div",fe,f(t.owner_name),1),F(" "+f(t.vin),1)]),l("div",ye,[r(M,{class:"mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900 block",amount:t.vehicle_price,currency:t.currency},null,8,["amount","currency"]),l("div",_e,f(t.formatted_vehicle_sale_date),1)])]),_:2},1032,["id","to","class"]))),128)),o(d).paintProtectionWarranties.length?S("",!0):(m(),I("p",he,f(e.$t("paint-protection-warranties.no_matching_paint-protection-warranty")),1))])]),l("div",ge,[o(D)?(m(),I("iframe",{key:0,ref:(t,V)=>{V.report=t},src:o(D),class:"flex-1 border border-gray-400 border-solid rounded-md",onClick:n[4]||(n[4]=(...t)=>e.ViewReportsPDF&&e.ViewReportsPDF(...t))},null,8,be)):S("",!0)])]),_:1})}}};export{Ve as default};
