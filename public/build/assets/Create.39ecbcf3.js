import{H as z,m as L,M as R,p as E,N as F,d as w,e as f,q as p,s as v,ak as j,x as A,r as a,o as N,k as $,i,a as o,g as t,b as h,h as I,n as J,z as K,t as O,w as Q}from"./main.2cb7c090.js";import{u as W}from"./notation.c182d613.js";const X=["onSubmit"],et={setup(Y){const n=W();z();const{t:d}=L(),_=R(),V=E();F();const c=w(!1);let r=w(!1);n.$reset(),S();const m=f(()=>_.name==="notations.edit"),b=f(()=>m.value?d("notations.edit_notation"):d("notations.new_notation")),q=f(()=>({currentNotation:{customer_id:{required:p.withMessage(d("validation.required"),v)},note_date:{required:p.withMessage(d("validation.required"),v)},note:{required:p.withMessage(d("validation.required"),v),maxLength:p.withMessage(d("validation.description_maxlength"),j(65e3))}}})),s=A(q,n);async function S(){if(r.value=!0,await new Promise(e=>setTimeout(e,2e3)),m.value){let e=_.params.id;await n.fetchNotation(e)}r.value=!1}async function y(){if(s.value.currentNotation.$touch(),s.value.currentNotation.$invalid)return!1;c.value=!0;try{let e={id:_.params.id,...n.currentNotation};await(m.value?n.updateNotation:n.addNotation)(e),c.value=!1,V.push("/admin/notations")}catch{c.value=!1;return}}return(e,l)=>{const g=a("BaseBreadcrumbItem"),C=a("BaseBreadcrumb"),k=a("BasePageHeader"),P=a("BaseCustomerSelectInput"),B=a("BaseInputGroup"),M=a("BaseDatePicker"),D=a("BaseTextarea"),T=a("BaseIcon"),G=a("BaseButton"),U=a("BaseInputGrid"),H=a("BaseCard"),x=a("BasePage");return N(),$(x,null,{default:i(()=>[o(k,{title:t(b)},{default:i(()=>[o(C,null,{default:i(()=>[o(g,{title:e.$t("general.home"),to:"dashboard"},null,8,["title"]),o(g,{title:e.$tc("notations.notation",2),to:"/admin/notations"},null,8,["title"]),o(g,{title:t(b),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),h("form",{class:"grid lg:grid-cols-2 mt-6",action:"submit",onSubmit:Q(y,["prevent"])},[o(H,{class:"w-full"},{default:i(()=>[o(U,{layout:"one-column"},{default:i(()=>[o(B,{label:e.$t("notations.customer"),error:t(s).currentNotation.customer_id.$error&&t(s).currentNotation.customer_id.$errors[0].$message,"content-loading":t(r),required:""},{default:i(()=>[t(r)?I("",!0):(N(),$(P,{key:0,modelValue:t(n).currentNotation.customer_id,"onUpdate:modelValue":l[0]||(l[0]=u=>t(n).currentNotation.customer_id=u),"content-loading":t(r),invalid:t(s).currentNotation.customer_id.$error,placeholder:e.$t("customers.select_a_customer")},null,8,["modelValue","content-loading","invalid","placeholder"]))]),_:1},8,["label","error","content-loading"]),o(B,{label:e.$t("notations.note_date"),"content-loading":t(r),required:"",error:t(s).currentNotation.note_date.$error&&t(s).currentNotation.note_date.$errors[0].$message},{default:i(()=>[o(M,{modelValue:t(n).currentNotation.note_date,"onUpdate:modelValue":l[1]||(l[1]=u=>t(n).currentNotation.note_date=u),"content-loading":t(r),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(B,{label:e.$t("notations.note"),"content-loading":t(r),required:"",error:t(s).currentNotation.note.$error&&t(s).currentNotation.note.$errors[0].$message},{default:i(()=>[o(D,{modelValue:t(n).currentNotation.note,"onUpdate:modelValue":l[2]||(l[2]=u=>t(n).currentNotation.note=u),"content-loading":t(r),name:"note",row:10,rows:"10",onInput:l[3]||(l[3]=u=>t(s).currentNotation.note.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),h("div",null,[o(G,{"content-loading":t(r),type:"submit",loading:c.value},{left:i(u=>[c.value?I("",!0):(N(),$(T,{key:0,name:"SaveIcon",class:J(u.class)},null,8,["class"]))]),default:i(()=>[K(" "+O(t(m)?e.$t("notations.update_notation"):e.$t("notations.save_notation")),1)]),_:1},8,["content-loading","loading"])])]),_:1})]),_:1})],40,X)]),_:1})}}};export{et as default};
